<!DOCTYPE html>
<html>
<head>
  <title>Google Sheet Search App</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
  <style>
    body { font-family: Arial, sans-serif; background: #f5f5f5; }
    .container { max-width: 800px; margin: 60px auto; background: #fff; padding: 32px 40px 40px 40px; border-radius: 12px; box-shadow: 0 4px 24px rgba(0,0,0,0.07); }
    .search-box { display: flex; justify-content: center; align-items: center; margin-bottom: 32px; }
    #search { width: 300px; padding: 10px 16px; border-radius: 6px 0 0 6px; border: 1px solid #bbb; font-size: 16px; outline: none; }
    #search-btn { border-radius: 0 6px 6px 0; border: 1px solid #bbb; background: #1976d2; color: white; padding: 0 20px; font-size: 18px; cursor: pointer; height: 40px; display: flex; align-items: center; border-left: none; }
    #search-btn:hover { background: #1565c0; }
    table { width: 100%; border-collapse: collapse; margin-bottom: 18px; }
    th, td { padding: 10px 8px; border-bottom: 1px solid #ddd; text-align: left; }
    th { background: #f0f2f5; }
    tr:hover { background: #fafafa; }
    .pagination { text-align: center; margin-top: 10px; }
    .pagination button { border: none; background: #e0e0e0; color: #333; padding: 6px 12px; margin: 0 2px; border-radius: 4px; cursor: pointer; }
    .pagination button.active, .pagination button:hover { background: #1976d2; color: white; }
  </style>
</head>
<body>
  <div class="container">
    <div class="search-box">
      <input type="text" id="search" placeholder="Type to search..." />
      <button id="search-btn"><i class="fas fa-search"></i> Search</button>
    </div>
    <div id="results"></div>
    <div class="pagination" id="pagination"></div>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
  <script>
    let data = [];
    let filtered = [];
    let currentPage = 1;
    const resultsPerPage = 10;

    function renderTable(page = 1) {
      const start = (page - 1) * resultsPerPage;
      const end = start + resultsPerPage;
      const pageData = filtered.slice(start, end);
      if (pageData.length === 0) {
        document.getElementById('results').innerHTML = '<p>No results found.</p>';
        document.getElementById('pagination').innerHTML = '';
        return;
      }
      let table = '<table><thead><tr>';
      Object.keys(pageData[0]).forEach(key => table += `<th>${key}</th>`);
      table += '</tr></thead><tbody>';
      pageData.forEach(row => {
        table += '<tr>';
        Object.values(row).forEach(val => table += `<td>${val || ''}</td>`);
        table += '</tr>';
      });
      table += '</tbody></table>';
      document.getElementById('results').innerHTML = table;
      renderPagination(page);
    }

    function renderPagination(page) {
      const totalPages = Math.ceil(filtered.length / resultsPerPage);
      let pag = '';
      for (let i = 1; i <= totalPages; i++) {
        pag += `<button class="${i === page ? 'active' : ''}" onclick="goToPage(${i})">${i}</button>`;
      }
      document.getElementById('pagination').innerHTML = pag;
    }

    window.goToPage = function(page) {
      currentPage = page;
      renderTable(page);
    };

    function searchData() {
      const query = document.getElementById('search').value.trim().toLowerCase();
      filtered = data.filter(row =>
        Object.values(row).some(val => val && val.toLowerCase().includes(query))
      );
      currentPage = 1;
      renderTable(currentPage);
    }

    document.getElementById('search').addEventListener('keydown', function(e) {
      if (e.key === 'Enter') searchData();
    });
    document.getElementById('search-btn').addEventListener('click', searchData);

    fetch('https://docs.google.com/spreadsheets/d/e/2PACX-1vSHAAiPFIlWiXooENqd4nDAqOzUfUNUlQoH-qQlCdnFTVmtnyeh1fbS-HNvnCtWb2Xp4YP0Ws8Xm_xS/pub?output=csv')
      .then(response => response.text())
      .then(csvText => {
        Papa.parse(csvText, {
          header: true,
          complete: function(results) {
            data = results.data;
            filtered = data; // show all initially
            renderTable(currentPage);
          }
        });
      });
  </script>
</body>
</html>
